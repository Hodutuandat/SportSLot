<!-- Owner Navigation Bar -->
<nav class="owner-navbar">
    <div class="navbar-container">
        <!-- Brand/Logo -->
        <div class="navbar-brand">
            <a href="{{ url_for('owner.dashboard') }}" class="brand-link">
                <div class="brand-logo">
                    <span class="logo-text">SportSlot</span>
                </div>
            </a>
        </div>

        <!-- Main Navigation -->
        <div class="navbar-menu">
            <div class="navbar-nav">
                <a href="{{ url_for('owner.dashboard') }}" class="nav-item {% if request.endpoint == 'owner.dashboard' %}active{% endif %}">
                    <span class="nav-text">Dashboard</span>
                </a>
                
                <a href="{{ url_for('owner.my_fields') }}" class="nav-item {% if request.endpoint == 'owner.my_fields' %}active{% endif %}">
                    <span class="nav-text">S√¢n c·ªßa t√¥i</span>
                </a>
                
                <a href="{{ url_for('owner.add_field') }}" class="nav-item {% if request.endpoint == 'owner.add_field' %}active{% endif %}">
                    <span class="nav-text">Th√™m s√¢n</span>
                </a>
                
                <a href="{{ url_for('owner.booking_schedule') }}" class="nav-item {% if request.endpoint == 'owner.booking_schedule' %}active{% endif %}">
                    <span class="nav-text">L·ªãch ƒë·∫∑t</span>
                </a>
                
                <a href="{{ url_for('owner.transaction_history') }}" class="nav-item {% if request.endpoint == 'owner.transaction_history' %}active{% endif %}">
                    <span class="nav-text">Doanh thu</span>
                </a>
            </div>
        </div>

        <!-- Revenue Display -->
        <div class="navbar-revenue">
            <div class="revenue-display">
                <div class="revenue-info">
                    <div class="revenue-amount">2.4M</div>
                    <div class="revenue-label">VNƒê h√¥m nay</div>
                </div>
            </div>
        </div>

        <!-- User Actions -->
        <div class="navbar-actions">
            <!-- Notifications Bell -->
            <div class="notification-bell">
                <button class="bell-button" onclick="toggleOwnerNotifications()">
                    <span class="bell-icon">üîî</span>
                    <span class="notification-badge">5</span>
                </button>
                
                <div class="notification-dropdown" id="ownerNotificationDropdown">
                    <div class="notification-header">
                        <div class="notification-header-left">
                            <h3>Th√¥ng b√°o</h3>
                            <span class="notification-count">5 m·ªõi</span>
                        </div>
                        <button class="mark-all-read" onclick="markAllNotificationsRead()">
                            <span class="mark-all-icon">‚úì</span>
                            ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc
                        </button>
                    </div>
                    
                    <div class="notification-filters">
                        <button class="filter-btn active" data-filter="all">T·∫•t c·∫£</button>
                        <button class="filter-btn" data-filter="urgent">Kh·∫©n c·∫•p</button>
                        <button class="filter-btn" data-filter="booking">Booking</button>
                        <button class="filter-btn" data-filter="payment">Thanh to√°n</button>
                    </div>
                    
                    <div class="notification-list">
                        <div class="notification-item unread urgent" data-type="booking" data-id="1">
                            <div class="notification-icon urgent-icon">‚ö†Ô∏è</div>
                            <div class="notification-content">
                                <div class="notification-title">
                                    <span class="notification-type-badge urgent">Kh·∫©n c·∫•p</span>
                                    Booking c·∫ßn duy·ªát g·∫•p
                                </div>
                                <div class="notification-text">
                                    <strong>S√¢n b√≥ng ƒë√° A</strong> - Kh√°ch h√†ng: Nguy·ªÖn VƒÉn Nam<br>
                                    <span class="booking-details">21/12/2024 15:00-17:00 | 400.000ƒë</span>
                                </div>
                                <div class="notification-actions">
                                    <button class="action-btn approve" onclick="approveBooking(1)">Duy·ªát</button>
                                    <button class="action-btn reject" onclick="rejectBooking(1)">T·ª´ ch·ªëi</button>
                                </div>
                                <div class="notification-time">5 ph√∫t tr∆∞·ªõc</div>
                            </div>
                        </div>
                        
                        <div class="notification-item unread" data-type="payment" data-id="2">
                            <div class="notification-icon payment-icon">üí∞</div>
                            <div class="notification-content">
                                <div class="notification-title">
                                    <span class="notification-type-badge payment">Thanh to√°n</span>
                                    Thanh to√°n th√†nh c√¥ng
                                </div>
                                <div class="notification-text">
                                    <strong>Booking #BK003</strong> - S√¢n Tennis Elite<br>
                                    <span class="payment-amount">400.000ƒë</span> | Ph∆∞∆°ng th·ª©c: VNPay
                                </div>
                                <div class="notification-time">30 ph√∫t tr∆∞·ªõc</div>
                            </div>
                        </div>
                        
                        <div class="notification-item unread" data-type="review" data-id="3">
                            <div class="notification-icon review-icon">‚≠ê</div>
                            <div class="notification-content">
                                <div class="notification-title">
                                    <span class="notification-type-badge review">ƒê√°nh gi√°</span>
                                    ƒê√°nh gi√° m·ªõi 5 sao
                                </div>
                                <div class="notification-text">
                                    <strong>S√¢n b√≥ng ƒë√° B</strong> - Kh√°ch h√†ng: Tr·∫ßn Minh Tu·∫•n<br>
                                    <span class="review-text">"S√¢n ƒë·∫πp, ch·∫•t l∆∞·ª£ng t·ªët, nh√¢n vi√™n ph·ª•c v·ª• nhi·ªát t√¨nh"</span>
                                </div>
                                <div class="notification-actions">
                                    <button class="action-btn view-review" onclick="viewReview(3)">Xem chi ti·∫øt</button>
                                </div>
                                <div class="notification-time">1 gi·ªù tr∆∞·ªõc</div>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-type="report" data-id="4">
                            <div class="notification-icon report-icon">üìä</div>
                            <div class="notification-content">
                                <div class="notification-title">
                                    <span class="notification-type-badge report">B√°o c√°o</span>
                                    B√°o c√°o doanh thu tu·∫ßn
                                </div>
                                <div class="notification-text">
                                    <strong>Tu·∫ßn n√†y:</strong> 15.2M VNƒê (+12% so v·ªõi tu·∫ßn tr∆∞·ªõc)<br>
                                    <span class="report-details">45 booking | 8.5 sao trung b√¨nh</span>
                                </div>
                                <div class="notification-actions">
                                    <a href="{{ url_for('owner.transaction_history') }}" class="action-btn view-report">Xem b√°o c√°o</a>
                                </div>
                                <div class="notification-time">2 gi·ªù tr∆∞·ªõc</div>
                            </div>
                        </div>
                        
                        <div class="notification-item" data-type="system" data-id="5">
                            <div class="notification-icon system-icon">‚úÖ</div>
                            <div class="notification-content">
                                <div class="notification-title">
                                    <span class="notification-type-badge system">H·ªá th·ªëng</span>
                                    S√¢n m·ªõi ƒë∆∞·ª£c duy·ªát
                                </div>
                                <div class="notification-text">
                                    <strong>S√¢n Tennis Elite</strong> ƒë√£ ƒë∆∞·ª£c ph√™ duy·ªát th√†nh c√¥ng<br>
                                    <span class="system-details">S√¢n s·∫Ω ho·∫°t ƒë·ªông t·ª´ ng√†y mai</span>
                                </div>
                                <div class="notification-time">1 ng√†y tr∆∞·ªõc</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="notification-footer">
                        <div class="notification-stats">
                            <span class="stats-item">5 th√¥ng b√°o m·ªõi</span>
                            <span class="stats-item">2 c·∫ßn x·ª≠ l√Ω</span>
                        </div>
                        <a href="{{ url_for('owner.notifications') }}" class="view-all-notifications">
                            Xem t·∫•t c·∫£ th√¥ng b√°o
                            <span class="view-all-arrow">‚Üí</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- User Menu Dropdown -->
            <div class="user-menu-dropdown">
                <button class="user-menu-trigger" onclick="toggleOwnerUserMenu()">
                    <div class="user-avatar owner-avatar">
                        <span class="avatar-text">{{ current_user.username[0].upper() }}</span>
                    </div>
                    <div class="user-info">
                        <span class="user-name">{{ current_user.username }}</span>
                        <span class="user-role">Ch·ªß s√¢n</span>
                    </div>
                    <span class="dropdown-arrow">‚åÑ</span>
                </button>
                
                <div class="user-menu-content" id="ownerUserMenuContent">
                    <div class="menu-header">
                        <div class="menu-avatar owner-menu-avatar">{{ current_user.username[0].upper() }}</div>
                        <div class="menu-user-info">
                            <div class="menu-user-name">{{ current_user.username }}</div>
                            <div class="menu-user-email">{{ current_user.username }}@sportslot.vn</div>
                            <div class="menu-user-badge">Owner Premium</div>
                        </div>
                    </div>
                    
                    <div class="menu-divider"></div>
                    
                    <div class="menu-items">
                        <a href="{{ url_for('owner.profile') }}" class="menu-item">
                            <span class="menu-text">H·ªì s∆° c√° nh√¢n</span>
                        </a>
                        
                        <a href="{{ url_for('owner.notifications') }}" class="menu-item">
                            <span class="menu-text">Th√¥ng b√°o</span>
                            <span class="menu-badge">5</span>
                        </a>
                        
                        <a href="{{ url_for('owner.transaction_history') }}" class="menu-item">
                            <span class="menu-text">B√°o c√°o chi ti·∫øt</span>
                        </a>
                    </div>
                    
                    <div class="menu-divider"></div>
                    
                    <div class="menu-footer">  
                        <a href="{{ url_for('auth.logout') }}" class="menu-item logout-item" id="owner-logout-btn">
                            <span class="menu-text">ƒêƒÉng xu·∫•t</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Menu Toggle -->
        <div class="mobile-menu-toggle">
            <button class="hamburger-btn" onclick="toggleOwnerMobileMenu()">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
        </div>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="ownerMobileMenuOverlay">
        <div class="mobile-menu-content">
            <div class="mobile-menu-header">
                <div class="mobile-brand">
                    <span class="logo-text">SportSlot Owner</span>
                </div>
                <button class="mobile-close-btn" onclick="toggleOwnerMobileMenu()">√ó</button>
            </div>
            
            <!-- User Info on Mobile -->
            <div class="mobile-user-info">
                <div class="mobile-avatar">{{ current_user.username[0].upper() }}</div>
                <div class="mobile-user-details">
                    <div class="mobile-user-name">{{ current_user.username }}</div>
                    <div class="mobile-user-role">Ch·ªß s√¢n th·ªÉ thao</div>
                </div>
            </div>
            
            <div class="mobile-divider"></div>
            
            <!-- Revenue Display Mobile -->
            <div class="mobile-revenue">
                <div class="mobile-revenue-text">
                    <span class="mobile-revenue-amount">2.4M VNƒê</span>
                    <span class="mobile-revenue-label">Doanh thu h√¥m nay</span>
                </div>
            </div>
            
            <div class="mobile-divider"></div>
            
            <div class="mobile-menu-items">
                <a href="{{ url_for('owner.dashboard') }}" class="mobile-nav-item">
                    <span class="nav-text">Dashboard</span>
                </a>
                
                <a href="{{ url_for('owner.my_fields') }}" class="mobile-nav-item">
                    <span class="nav-text">S√¢n c·ªßa t√¥i</span>
                </a>
                
                <a href="{{ url_for('owner.add_field') }}" class="mobile-nav-item highlight">
                    <span class="nav-text">Th√™m s√¢n</span>
                </a>
                
                <a href="{{ url_for('owner.booking_schedule') }}" class="mobile-nav-item">
                    <span class="nav-text">L·ªãch ƒë·∫∑t s√¢n</span>
                </a>
                
                <a href="{{ url_for('owner.transaction_history') }}" class="mobile-nav-item">
                    <span class="nav-text">Doanh thu</span>
                </a>
                
                <a href="{{ url_for('owner.notifications') }}" class="mobile-nav-item">
                    <span class="nav-text">Th√¥ng b√°o</span>
                    <span class="mobile-badge">5</span>
                </a>
                
                <div class="mobile-divider"></div>
                
                <a href="{{ url_for('owner.profile') }}" class="mobile-nav-item">
                    <span class="nav-text">H·ªì s∆° c√° nh√¢n</span>
                </a>
                
                <a href="#" class="mobile-nav-item">
                    <span class="nav-text">C√†i ƒë·∫∑t</span>
                </a>
                
                <a href="#" class="mobile-nav-item">
                    <span class="nav-text">H·ªó tr·ª£</span>
                </a>
                
                <a href="{{ url_for('auth.logout') }}" class="mobile-nav-item logout">
                    <span class="nav-text">ƒêƒÉng xu·∫•t</span>
                </a>
            </div>
        </div>
    </div>
</nav>

<!-- Owner Navbar JavaScript -->
<script>
function toggleOwnerUserMenu() {
    const menu = document.getElementById('ownerUserMenuContent');
    menu.classList.toggle('show');
    
    // Close notification dropdown if open
    const notificationDropdown = document.getElementById('ownerNotificationDropdown');
    notificationDropdown.classList.remove('show');
}

function toggleOwnerNotifications() {
    const dropdown = document.getElementById('ownerNotificationDropdown');
    dropdown.classList.toggle('show');
    
    // Close user menu if open
    const userMenu = document.getElementById('ownerUserMenuContent');
    userMenu.classList.remove('show');
}

function toggleOwnerMobileMenu() {
    const overlay = document.getElementById('ownerMobileMenuOverlay');
    overlay.classList.toggle('show');
    document.body.classList.toggle('mobile-menu-open');
}



// Close dropdowns when clicking outside
document.addEventListener('click', function(event) {
    const userMenu = document.querySelector('.owner-navbar .user-menu-dropdown');
    const notificationBell = document.querySelector('.owner-navbar .notification-bell');
    
    if (userMenu && !userMenu.contains(event.target)) {
        document.getElementById('ownerUserMenuContent').classList.remove('show');
    }
    
    if (notificationBell && !notificationBell.contains(event.target)) {
        document.getElementById('ownerNotificationDropdown').classList.remove('show');
    }
});

// Notification functions
function markAllNotificationsRead() {
    const unreadItems = document.querySelectorAll('.notification-item.unread');
    unreadItems.forEach(item => {
        item.classList.remove('unread');
    });
    
    // Update notification count
    const badge = document.querySelector('.notification-badge');
    const count = document.querySelector('.notification-count');
    if (badge) badge.textContent = '0';
    if (count) count.textContent = '0 m·ªõi';
    
    // Show success message
    showNotificationToast('ƒê√£ ƒë√°nh d·∫•u t·∫•t c·∫£ th√¥ng b√°o ƒë√£ ƒë·ªçc');
}

function approveBooking(bookingId) {
    // Simulate API call
    showNotificationToast('ƒê√£ duy·ªát booking #' + bookingId);
    
    // Remove the notification item
    const notificationItem = document.querySelector(`[data-id="${bookingId}"]`);
    if (notificationItem) {
        notificationItem.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
            notificationItem.remove();
            updateNotificationCount();
        }, 300);
    }
}

function rejectBooking(bookingId) {
    // Simulate API call
    showNotificationToast('ƒê√£ t·ª´ ch·ªëi booking #' + bookingId);
    
    // Remove the notification item
    const notificationItem = document.querySelector(`[data-id="${bookingId}"]`);
    if (notificationItem) {
        notificationItem.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
            notificationItem.remove();
            updateNotificationCount();
        }, 300);
    }
}

function viewReview(reviewId) {
    showNotificationToast('M·ªü trang ƒë√°nh gi√° #' + reviewId);
    // Redirect to review page
    // window.location.href = '/owner/reviews/' + reviewId;
}

function viewReport(reportId) {
    showNotificationToast('M·ªü b√°o c√°o #' + reportId);
    // Redirect to transaction history page
    window.location.href = '{{ url_for("owner.transaction_history") }}';
}

function updateNotificationCount() {
    const unreadItems = document.querySelectorAll('.notification-item.unread');
    const badge = document.querySelector('.notification-badge');
    const count = document.querySelector('.notification-count');
    
    if (badge) badge.textContent = unreadItems.length;
    if (count) count.textContent = unreadItems.length + ' m·ªõi';
}

function showNotificationToast(message) {
    // Create toast notification
    const toast = document.createElement('div');
    toast.className = 'notification-toast';
    toast.textContent = message;
    toast.style.cssText = `
        position: fixed;
        top: 100px;
        right: 20px;
        background: #10b981;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        font-weight: 600;
        z-index: 10000;
        animation: slideInRight 0.3s ease;
    `;
    
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.style.animation = 'slideOutRight 0.3s ease';
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, 300);
    }, 3000);
}

// Filter notifications
document.addEventListener('DOMContentLoaded', function() {
    const filterBtns = document.querySelectorAll('.filter-btn');
    
    filterBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const filter = this.getAttribute('data-filter');
            
            // Update active button
            filterBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Filter notifications
            const notifications = document.querySelectorAll('.notification-item');
            notifications.forEach(item => {
                if (filter === 'all' || item.getAttribute('data-type') === filter) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    });
});

// Update revenue display (simulated)
function updateRevenueDisplay() {
    const revenueAmount = document.querySelector('.revenue-amount');
    const mobileRevenueAmount = document.querySelector('.mobile-revenue-amount');
    
    // Simulate real-time revenue updates
    setInterval(() => {
        const currentAmount = parseFloat(revenueAmount.textContent.replace('M', ''));
        const newAmount = (currentAmount + Math.random() * 0.1).toFixed(1);
        
        revenueAmount.textContent = newAmount + 'M';
        if (mobileRevenueAmount) {
            mobileRevenueAmount.textContent = newAmount + 'M VNƒê';
        }
    }, 30000); // Update every 30 seconds
}

// Initialize revenue updates
document.addEventListener('DOMContentLoaded', updateRevenueDisplay);
</script> 