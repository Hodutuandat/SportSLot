{% extends "base.html" %}

{% block title %}Chi ti·∫øt ƒë·∫∑t s√¢n - SportSlot{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/customer/booking_detail.css') }}">
{% endblock %}

{% block content %}
<div class="booking-detail-container">
    <!-- Header Section -->
    <div class="main-header">
        <div class="header-content">
            <div class="header-left">
                <h1>üìã Chi ti·∫øt ƒë·∫∑t s√¢n</h1>
                <p class="header-subtitle">Th√¥ng tin chi ti·∫øt v·ªÅ l·∫ßn ƒë·∫∑t s√¢n c·ªßa b·∫°n</p>
            </div>
            <div class="header-actions">
                <a href="{{ url_for('customer.booking_history') }}" class="back-btn">
                    <i class="fas fa-arrow-left"></i>
                    Quay l·∫°i
                </a>
            </div>
        </div>
    </div>

    <!-- Booking Information Card -->
    <div class="booking-card" data-booking-id="{{ booking.id }}" data-field-id="{{ booking.field_id }}">
        <div class="booking-header">
            <div class="booking-code">
                <h2>{{ booking.booking_code }}</h2>
                <span class="status-badge status-{{ booking.status }}">
                    {% if booking.status == 'completed' %}
                        Ho√†n th√†nh
                    {% elif booking.status == 'confirmed' %}
                        ƒê√£ x√°c nh·∫≠n
                    {% elif booking.status == 'pending' %}
                        Ch·ªù x√°c nh·∫≠n
                    {% elif booking.status == 'cancelled' %}
                        ƒê√£ h·ªßy
                    {% else %}
                        {{ booking.status }}
                    {% endif %}
                </span>
            </div>
            <div class="booking-date">
                <i class="fas fa-calendar"></i>
                {{ booking.booking_date }}
            </div>
        </div>

        <!-- Field Information -->
        <div class="field-info">
            <div class="field-header">
                <h3>üèüÔ∏è Th√¥ng tin s√¢n</h3>
            </div>
            <div class="field-details">
                <div class="field-item">
                    <div class="field-label">
                        <i class="fas fa-map-marker-alt"></i>
                        T√™n s√¢n
                    </div>
                    <div class="field-value">{{ booking.field_name }}</div>
                </div>
                <div class="field-item">
                    <div class="field-label">
                        <i class="fas fa-location-arrow"></i>
                        ƒê·ªãa ch·ªâ
                    </div>
                    <div class="field-value">{{ booking.field_address }}</div>
                </div>
                <div class="field-item">
                    <div class="field-label">
                        <i class="fas fa-futbol"></i>
                        Lo·∫°i s√¢n
                    </div>
                    <div class="field-value">{{ booking.field_type }}</div>
                </div>
            </div>
        </div>

        <!-- Booking Details -->
        <div class="booking-details">
            <div class="booking-header">
                <h3>‚è∞ Th√¥ng tin ƒë·∫∑t s√¢n</h3>
            </div>
            <div class="booking-grid">
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-clock"></i>
                        Gi·ªù b·∫Øt ƒë·∫ßu
                    </div>
                    <div class="detail-value">{{ booking.start_time }}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-clock"></i>
                        Gi·ªù k·∫øt th√∫c
                    </div>
                    <div class="detail-value">{{ booking.end_time }}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-hourglass-half"></i>
                        Th·ªùi gian
                    </div>
                    <div class="detail-value">{{ booking.duration }} gi·ªù</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-money-bill-wave"></i>
                        T·ªïng ti·ªÅn
                    </div>
                    <div class="detail-value price">{{ "{:,}".format(booking.total_price) }} VNƒê</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-credit-card"></i>
                        Ph∆∞∆°ng th·ª©c thanh to√°n
                    </div>
                    <div class="detail-value">{{ booking.payment_method }}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">
                        <i class="fas fa-calendar-plus"></i>
                        Ng√†y ƒë·∫∑t
                    </div>
                    <div class="detail-value">{{ booking.created_at }}</div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="booking-actions">
            {% if booking.status == 'pending' %}
            <div class="action-buttons">
                <button class="btn-secondary" onclick="cancelBooking('{{ booking.id }}')">
                    <i class="fas fa-times"></i>
                    H·ªßy ƒë·∫∑t s√¢n
                </button>
                <button class="btn-primary" onclick="contactOwner()">
                    <i class="fas fa-phone"></i>
                    Li√™n h·ªá ch·ªß s√¢n
                </button>
            </div>
            {% elif booking.status == 'confirmed' %}
            <div class="action-buttons">
                <button class="btn-secondary" onclick="cancelBooking('{{ booking.id }}')">
                    <i class="fas fa-times"></i>
                    H·ªßy ƒë·∫∑t s√¢n
                </button>
                <button class="btn-primary" onclick="contactOwner()">
                    <i class="fas fa-phone"></i>
                    Li√™n h·ªá ch·ªß s√¢n
                </button>
            </div>
            {% elif booking.status == 'completed' %}
            <div class="action-buttons">
                <button class="btn-primary" onclick="rateBooking()">
                    <i class="fas fa-star"></i>
                    ƒê√°nh gi√°
                </button>
                <button class="btn-secondary" onclick="bookAgain()">
                    <i class="fas fa-redo"></i>
                    ƒê·∫∑t l·∫°i
                </button>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Additional Information -->
    <div class="additional-info">
        <div class="info-card">
            <h3>üìû H·ªó tr·ª£</h3>
            <p>N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi n√†o v·ªÅ l·∫ßn ƒë·∫∑t s√¢n n√†y, vui l√≤ng li√™n h·ªá:</p>
            <div class="contact-info">
                <div class="contact-item">
                    <i class="fas fa-phone"></i>
                    <span>Hotline: 1900-1234</span>
                </div>
                <div class="contact-item">
                    <i class="fas fa-envelope"></i>
                    <span>Email: support@sportslot.com</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Cancel Booking Modal -->
<div id="cancel-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>X√°c nh·∫≠n h·ªßy ƒë·∫∑t s√¢n</h3>
            <span class="close" onclick="closeCancelModal()">&times;</span>
        </div>
        <div class="modal-body">
            <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy l·∫ßn ƒë·∫∑t s√¢n n√†y kh√¥ng?</p>
            <p><strong>M√£ ƒë·∫∑t s√¢n:</strong> {{ booking.booking_code }}</p>
            <p><strong>S√¢n:</strong> {{ booking.field_name }}</p>
            <p><strong>Ng√†y:</strong> {{ booking.booking_date }}</p>
            <p><strong>Gi·ªù:</strong> {{ booking.start_time }} - {{ booking.end_time }}</p>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeCancelModal()">Kh√¥ng h·ªßy</button>
            <button class="btn-danger" onclick="confirmCancel()">X√°c nh·∫≠n h·ªßy</button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/customer/booking_detail.js') }}"></script>
{% endblock %} 